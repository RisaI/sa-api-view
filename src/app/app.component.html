<app-header
  (changeOrientation)="onChangeOrientation()"
  (addGraph)="onAddGraph()"
></app-header>

<app-side-menu>

  <!-- Graph controls -->
  <ng-container *ngIf="selectedGraph !== undefined; else noGraph">
    <div>
      <a
        class="nav-btn ion-arrow-up-c"
        [class.active]="canMoveUp()"
        (click)="canMoveUp() && moveUp()"
      ></a>
      <a
        class="nav-btn ion-arrow-down-c"
        [class.active]="canMoveDown()"
        (click)="canMoveDown() && moveDown()"
      ></a>
      <a class="nav-btn active ion-trash-b" (click)="removeGraph()"></a>
    </div>
    <ul class="sidebar-menu"><li class="header">VLASTNOSTI</li></ul>
    <form style="color: white">
      <div class="form-group"><label>Název:</label><input class="form-control" type="text" value="{{selectedGraph.title}}"  (change)="selectedGraph().title  = $event.target.value"></div>
      <div class="form-group"><label>Osa x:</label><input class="form-control" type="text" value="{{selectedGraph.xLabel}}" (change)="selectedGraph().xLabel = $event.target.value"></div>
      <div class="form-group"><label>Osa y:</label><input class="form-control" type="text" value="{{selectedGraph.yLabel}}" (change)="selectedGraph().yLabel = $event.target.value"></div>
    </form>
    <ul class="sidebar-menu"><li class="header" style="display: flex; align-items: center;">KŘIVKY<span class="btn btn-menu ion-android-add active" (click)="traceImportOpen = true"></span></li></ul>
    <app-trace-controls (action)="traceControl($event)"></app-trace-controls>
    <app-trace-list
      [traces]="selectedGraph.traces"
      [selected]="selectedTraces"
      (toggle)="toggleTrace($event)">
    </app-trace-list>
  </ng-container>

  <ng-template #noGraph>
    <ul class="sidebar-menu"><li class="header">VYBERTE GRAF</li></ul>
  </ng-template>
</app-side-menu>

<!-- TODO: Spinner -->

<div class="content-wrapper">
  <section class="container-fluid container-graphs" [class.horizontal]="horizontal">
    <app-graph-view
      *ngFor="let graph of graphs"
      [graph]="graph"
      [traces]="graph.traces"
      [class.active]="selectedGraph === graph"
      (click)="selectedGraph = graph; selectedTraces = []">
    </app-graph-view>
  </section>
</div>

<app-trace-import-modal [show]="traceImportOpen" [usedIds]="selectedGraphTraceIds()" (toggle)="traceImportOpen = false" (import)="importTrace($event)"></app-trace-import-modal>